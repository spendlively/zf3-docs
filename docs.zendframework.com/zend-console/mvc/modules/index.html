<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <link rel="shortcut icon" href="../../img/favicon.ico">

    <title>Console-Aware Modules - zend-console</title>

    <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href="//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Libre+Baskerville:400,400italic,700&subset=latin,latin-ext" rel="stylesheet" type="text/css">
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/zf-web.css" rel="stylesheet">
    <link href="../../css/zf.css" rel="stylesheet">
    <link href="../../css/prism-zf.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <span class="navbar-brand">
              <a class="logo-link" href="http://framework.zend.com" data-toggle="tooltip" data-placement="bottom" title="Zend Framework"><img src="../../img/zf-logo-mark.svg" height="28" alt="Zend Framework" /></a>
              <a href="../..">zend-console</a>
            </span>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../../intro/">Intro</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../adapter/">Console Adapters</a>
</li>

                        
                            
<li >
    <a href="../../prompts/">Console Prompts</a>
</li>

                        
                            
<li >
    <a href="../../routes/">Routes</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">MVC Integration <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../routing/">MVC Routing</a>
</li>

                        
                            
<li class="active">
    <a href="./">Console-Aware Modules</a>
</li>

                        
                            
<li >
    <a href="../controllers/">Console-Aware Controllers</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getopt <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../../getopt/intro/">Introduction</a>
</li>

                        
                            
<li >
    <a href="../../getopt/rules/">Declaring Rules</a>
</li>

                        
                            
<li >
    <a href="../../getopt/fetching/">Fetching Options and Arguments</a>
</li>

                        
                            
<li >
    <a href="../../getopt/configuration/">Configuration</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" class="component-toggle" data-toggle="tooltip" data-placement="bottom" title="Show component list">
                        <i class="fa fa-book"></i> Components
                    </a>
                </li>

                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li>
                        <a href="https://github.com/zendframework/zend-console">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <!-- content:begin -->
    <div id="page-top" class="container docs">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#console-aware-modules">Console-aware modules</a></li>
        
            <li><a href="#application-banner">Application banner</a></li>
        
            <li><a href="#usage-information">Usage information</a></li>
        
            <li><a href="#best-practices">Best practices</a></li>
        
    
    </ul>

    
    <ul class="pager hidden-print">
      <li class="previous">
        <a rel="prev" href="../routing/"><i class="fa fa-arrow-left"></i> Previous</a>
      </li>
      <li class="next">
        <a rel="next" href="../controllers/">Next <i class="fa fa-arrow-right"></i></a>
      </li>
    </ul>
    
</div></div>
        <div class="col-md-9" role="main">

<ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
  <li><a href="../..">zend-console</a> &raquo;</li>
  
    
      
        <li>MVC Integration &raquo;</li>
      
    
  
  <li class="active">Console-Aware Modules</li>
</ol>

<h1 id="console-aware-modules">Console-aware modules</h1>
<p>zend-mvc integrates with zend-console; the integration also works with modules
loaded with the
<a href="http://framework.zend.com/manual/current/en/modules/zend.module-manager.intro.html">Module Manager</a>.</p>
<p>zend-mvc ships with a console-specific <code>RouteNotFoundStrategy</code> which is responsible for displaying console usage information when:</p>
<ul>
<li>the user has not provided any arguments; or</li>
<li>arguments could not be matched by any routes.</li>
</ul>
<p>The strategy currently supports two types of information: <a href="#application-banner">application
banners</a> and <a href="#usage-information">usage information</a>.</p>
<h2 id="application-banner">Application banner</h2>
<p>When using zend-console within a zend-mvc application, you can invoke it via
the application bootstrap:</p>
<pre class="codehilite"><code class="language-bash">$ php public/index.php</code></pre>


<p>By default, it will simply output the current ZF 2 version, like this:</p>
<p><img alt="Basic console invocation" src="../../images/zend.console.empty.png" class="img-responsive"/></p>
<p>Our <code>Application</code> module (and any other module) can provide an <strong>application
banner</strong>. In order to do so, our <code>Module</code> class has to implement
<code>Zend\ModuleManager\Feature\ConsoleBannerProviderInterface</code>. As an example:</p>
<pre class="codehilite"><code class="language-php">// module/Application/Module.php
&lt;?php
namespace Application;

use Zend\ModuleManager\Feature\ConsoleBannerProviderInterface;
use Zend\Console\Adapter\AdapterInterface as Console;

class Module implements ConsoleBannerProviderInterface
{
    /**
     * This method is defined in ConsoleBannerProviderInterface
     */
    public function getConsoleBanner(Console $console)
    {
        return 'MyModule 0.0.1';
    }
}</code></pre>


<p>As you can see, the application banner should be a single line string that
returns the module's name and (if available) its current version.</p>
<p>If several modules define their own banner, they are displayed one after the
other in the order in which the modules are loaded. This allows you to see at a
glance which modules expose console commands.</p>
<p>If we execute our console application now, we'll see the newly created banner:</p>
<p><img alt="Application banner" src="../../images/zend.console.banner.png" class="img-responsive"/></p>
<p>Let's create and load a second module that provides a banner:</p>
<pre class="codehilite"><code class="language-php">&lt;?php
// config/application.config.php
return array(
    'modules' =&gt; array(
        'Application',
        'User',     // &lt;- load user module in module/User
    ),</code></pre>


<p>The <code>User</code> module will provide info about itself:</p>
<pre class="codehilite"><code class="language-php">// module/User/Module.php
&lt;?php
namespace User;

use Zend\ModuleManager\Feature\ConsoleBannerProviderInterface;
use Zend\Console\Adapter\AdapterInterface as Console;

class Module implements ConsoleBannerProviderInterface
{
    /**
     * This method is defined in ConsoleBannerProviderInterface
     */
    public function getConsoleBanner(Console $console)
    {
        return &quot;User Module 0.0.1&quot;;
    }
}</code></pre>


<p>Because the <code>User</code> module is loaded after the <code>Application</code> module, the result
will look like this:</p>
<p><img alt="Two modules" src="../../images/zend.console.banner2.png" class="img-responsive"/></p>
<blockquote>
<h3 id="application-banner-display">Application banner display</h3>
<p>Application banners provided by modules are displayed as-is &mdash; no
trimming or other adjustments will be performed on the text. As you can see,
banners are also automatically colorized as blue.</p>
</blockquote>
<h2 id="usage-information">Usage information</h2>
<p>In order to display usage information, our Module class must implement
<code>Zend\ModuleManager\Feature\ConsoleUsageProviderInterface</code>. Let's modify our
example and add the new method defined in that interface:</p>
<pre class="codehilite"><code class="language-php">// module/Application/Module.php
&lt;?php
namespace Application;

use Zend\ModuleManager\Feature\ConsoleBannerProviderInterface;
use Zend\ModuleManager\Feature\ConsoleUsageProviderInterface;
use Zend\Console\Adapter\AdapterInterface as Console;

class Module implements
    ConsoleBannerProviderInterface,
    ConsoleUsageProviderInterface
{
    public function getConsoleBanner(Console $console)
    {
        /* ... */
    }

    /**
     * This method is defined in ConsoleUsageProviderInterface
     */
    public function getConsoleUsage(Console $console)
    {
        return [
            'show stats'             =&gt; 'Show application statistics',
            'run cron'               =&gt; 'Run automated jobs',
            '(enable|disable) debug' =&gt; 'Enable or disable debug mode for the application.',
        ];
    }
}</code></pre>


<p>This will display the following information:</p>
<p><img alt="Console usage" src="../../images/zend.console.usage.png" class="img-responsive"/></p>
<p>Similar to <a href="#application-banner">application banners</a>, multiple modules can
provide usage information, which will be joined together and displayed to the
user. The order in which usage information is displayed is the order in which
modules are loaded.</p>
<p>As you can see, the zend-mvc integration also prepends each module's usage with
the module's name. This helps to visually separate commands by module &mdash;
which is particularly useful when you have multiple modules providing commands.
By default, the component colorizes the module names in red.</p>
<blockquote>
<h3 id="usage-information-is-arbitrary">Usage information is arbitrary</h3>
<p>Usage info provided in modules is not connected with <a href="../../routes/">console
routing</a>. You can describe console usage in any form you prefer,
and it does not affect how MVC handles console commands. In order to handle
real console requests, you still need to define console routes.</p>
</blockquote>
<h3 id="free-form-text">Free-form text</h3>
<p>In order to output free-form text as usage information, <code>getConsoleUsage()</code> can
return a string or an array of strings. As an example, the following is a
single, free-form usage text:</p>
<pre class="codehilite"><code class="language-php">public function getConsoleUsage(Console $console)
{
    return 'User module expects exactly one argument - user name. '
        . 'It will display information for the provided user.';
}</code></pre>


<p><img alt="Free-form usage text" src="../../images/zend.console.usage2.png" class="img-responsive"/></p>
<blockquote>
<h4 id="usage-text-is-provided-as-is">Usage text is provided as-is</h4>
<p>The text provided is displayed as-is; no trimming or other adjustments will
be performed. If you'd like to fit your usage information inside the console
window, you could check its width with <code>$console-getWidth()</code>.</p>
</blockquote>
<h3 id="list-of-commands">List of commands</h3>
<p>If <code>getConsoleUsage()</code> returns an associative array, it will be automatically
aligned in 2 columns.  The first column will be prepended with script name (the
entry point for the application). This is useful to display the various
commands exposed.</p>
<pre class="codehilite"><code class="language-php">public function getConsoleUsage(Console $console)
{
     return [
        'delete user &lt;userEmail&gt;'        =&gt; 'Delete user with email &lt;userEmail&gt;',
        'disable user &lt;userEmail&gt;'       =&gt; 'Disable user with email &lt;userEmail&gt;',
        'list [all|disabled] users'      =&gt; 'Show a list of users',
        'find user [--email=] [--name=]' =&gt; 'Attempt to find a user by email or name',
     ];
}</code></pre>


<p><img alt="Listing multiple commands" src="../../images/zend.console.usage3.png" class="img-responsive"/></p>
<blockquote>
<h4 id="command-list-alignment">Command list alignment</h4>
<p>Commands and their descriptions will be aligned in two columns that fit
inside the terminal window. If the window is resized, text may wrap, but all
content will be aligned. If you don't like the behavior, you can always
return <a href="../free-form-text">free-form text</a> instead, as free-form text is never
transformed or aligned.</p>
</blockquote>
<h3 id="list-of-params-and-flags">List of params and flags</h3>
<p>Returning an array of arrays from <code>getConsoleUsage()</code> will produce a listing of
parameters. This is useful for explaining flags, switches, possible values and
other information. The output will be aligned in multiple columns for
readability.</p>
<p>As an example:</p>
<pre class="codehilite"><code class="language-php">public function getConsoleUsage(Console $console)
{
    return [
        [ '&lt;userEmail&gt;', 'email of the user' ],
        [ '--verbose',   'Turn on verbose mode' ],
        [ '--quick',     'Perform a &quot;quick&quot; operation' ],
        [ '-v',          'Same as --verbose' ],
        [ '-w',          'Wide output'],
    );
}</code></pre>


<p><img alt="Parameter lists" src="../../images/zend.console.usage4.png" class="img-responsive"/></p>
<p>This method can be used to display more than 2 columns of information:</p>
<pre class="codehilite"><code class="language-php">public function getConsoleUsage(Console $console)
{
    return [
        [ '&lt;userEmail&gt;', 'user email',        'Full email address of the user to find.' ],
        [ '--verbose',   'verbose mode',      'Display additional information during processing' ],
        [ '--quick',     '&quot;quick&quot; operation', 'Do not check integrity, just make changes and finish' ],
        [ '-v',          'Same as --verbose', 'Display additional information during processing' ],
        [ '-w',          'wide output',       'When listing users, use the whole available screen width' ],
    ];
}</code></pre>


<p><img alt="Multiple columns" src="../../images/zend.console.usage5.png" class="img-responsive"/></p>
<blockquote>
<h4 id="alignment">Alignment</h4>
<p>All information will be aligned in one or more columns that fit inside the
terminal window. If the window is resized, some text may wrap, but all
content will remain aligned. In case the number of columns changes (e.g. the
array contains different number of elements), a new table will be created,
with its own alignment and column widths.</p>
<p>If you don't like this behavior, you can always return <a href="../free-form-text">free-form text</a>.</p>
</blockquote>
<h3 id="mixing-styles">Mixing styles</h3>
<p>You can use mix together all of the above styles to provide comprehensive usage information.</p>
<pre class="codehilite"><code class="language-php">public function getConsoleUsage(Console $console)
{
    return [
        'Finding and listing users',
        'list [all|disabled] users [-w]' =&gt; 'Show a list of users',
        'find user [--email=] [--name=]' =&gt; 'Attempt to find a user by email or name',

        ['[all|disabled]', 'Display all users or only disabled accounts'],
        ['--email=EMAIL',  'Email of the user to find'],
        ['--name=NAME',    'Full name of the user to find.'],
        ['-w',             'Wide output - When listing users use the whole available screen width'],

        'Manipulation of user database:',
        'delete user &lt;userEmail&gt; [--verbose|-v] [--quick]' =&gt; 'Delete user with email &lt;userEmail&gt;',
        'disable user &lt;userEmail&gt; [--verbose|-v]'          =&gt; 'Disable user with email &lt;userEmail&gt;',

        [ '&lt;userEmail&gt;', 'user email',        'Full email address of the user to change.'],
        [ '--verbose',   'verbose mode',      'Display additional information during processing'],
        [ '--quick',     '&quot;quick&quot; operation', 'Do not check integrity, just make changes and finish'],
        [ '-v',          'Same as --verbose', 'Display additional information during processing'],

    );
}</code></pre>


<p><img alt="Mixed styles" src="../../images/zend.console.usage6.png" class="img-responsive"/></p>
<h2 id="best-practices">Best practices</h2>
<p>Here are the best practices when providing usage for your commands:</p>
<ol>
<li>Your module's <code>getConsoleBanner()</code> method should return a one-line string
   containing the module's name and its version (if available); do not provide any
   other information.</li>
<li>Your <code>getConsoleUsage()</code> method should <em>not</em> return the module's name, as it
   is prepended automatically for you by the zend-mvc integration.</li>
</ol>

<hr />


<nav>
  <ul class="pager hidden-print">
    <li class="previous">
      <a rel="prev" href="../routing/"><i class="fa fa-arrow-left"></i> Previous</a>
    </li>
    <li class="next">
      <a rel="next" href="../controllers/">Next <i class="fa fa-arrow-right"></i></a>
    </li>
  </ul>
</nav>
</div>
        
    </div>
    <!-- content:end -->

    <div id="footerwrap">
    <div class="container">
        <div class="row site-map">
            <div class="col-lg-3">
              <p>
                <strong>Zend Framework</strong><br />
                <a href="http://framework.zend.com/">framework.zend.com</a><br />
                <a href="https://docs.zendframework.com">docs.zendframework.com</a><br />
                <a href="https://packages.zendframework.com">packages.zendframework.com</a><br />
                <a href="https://apigility.org">apigility.org</a><br />
              </p>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 centered">
                <a class="back-to-top" href="#page-top"><i class="fa fa-chevron-circle-up fa-4" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="spacing"></div>

        <div class="row">
            <div class="col-lg-8">
                <h4>Copyright</h4>
                <div class="hline-w"></div>

                <p>&copy; 2006-2016 by <a href="http://www.zend.com">Zend</a>, a <a href="http://www.roguewave.com/">Rogue Wave Company</a>.</p>
            </div>

            <div class="col-lg-4">
                <h4>Contacts</h4>
                <div class="hline-w"></div>
                <p>
                    <a href="irc://irc.freenode.net/zftalk" class="btn-social btn-outline" alt="IRC" title="IRC"><i class="fa fa-comment"></i></a>
                    <a href="https://github.com/zendframework" class="btn-social btn-outline" alt="Github" title="Github"><i class="fa fa-github"></i></a>
                    <a href="https://twitter.com/zfdevteam" class="btn-social btn-outline" alt="Twitter" title="Twitter"><i class="fa fa-twitter"></i></a>
                </p>
            </div>
        </div>
    </div>
</div>


    <script src="../../js/jquery-1.10.2.min.js"></script>
    <script src="../../js/bootstrap-3.0.3.min.js"></script>
    <script src="../../js/prism-zf.js"></script>

    <script>var base_url = '../..';</script>
    <script data-main="../../mkdocs/js/search.js" src="../../mkdocs/js/require.js"></script>
    <script src="../../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    <div class="zf-components">
  <div class="zf-components-grid">
    <div class="zf-logo">
      <a href="http://framework.zend.com" data-toggle="tooltip" data-placement="bottom" title="Go to the ZF homepage"><img src="../../img/zf-logo-mark.svg" alt="Zend Framework" width="250" /></a>
    </div>

    <div class="component-list"></div>

    <p class="zf-components-rollup"><a href="#">Hide list</a></p>
  </div>
</div>

    <script>
  // Prepare the component list dropdown for display
  $(function () {
    var components = $(".zf-components"),
        componentList = components.find(".component-list"),
        sidebar = $(".bs-sidebar.affix"),
        sidebarInitialPos = sidebar.css("position"),
        hidden,
        componentToggle = $(".component-toggle"),
        navbar = $(".navbar-fixed-top"),
        rollUpLink = $(".zf-components-rollup a");

    // Initial setup on document load
    components.insertBefore(navbar);
    $(".zf-logo a").tooltip();
    componentToggle.tooltip();
    rollUpLink.attr({ href: "#", alt: "Hide component list" });

    // Cast initial sidebar position value
    if (undefined === sidebarInitialPos) {
      sidebarInitialPos = "fixed";
    }

    // Setup onclick events to toggle list
    componentToggle.click(toggleComponentList);
    rollUpLink.click(toggleComponentList);

    // Toggle the component list display
    function toggleComponentList(event) {
      event.preventDefault();

      if (hidden === undefined) {
        // Not loaded yet; load and display.
        loadComponentList();
        return;
      }

      if (hidden) {
        // Hidden; display.
        showComponentList();
        return;
      }

      // Currently visible; hide
      hideComponentList();
    }

    // Show the component list
    function showComponentList() {
      navbar.css({position: "relative"});
      sidebar.css({position: "relative"});
      components
        .css({"margin-top": "-" + components.outerHeight() + "px"})
        .show()
        .animate({"margin-top": 0}, {
          complete: function () {
            componentToggle
              .data("placement", "top")
              .attr("data-original-title", "Hide component list");
            hidden = false;
          },
          queue: false
        });
    }

    // Hide the component list
    function hideComponentList() {
      components.animate({"margin-top": "-" + components.outerHeight() + "px"}, {
        complete: function () {
          navbar.css({position: "fixed"});
          sidebar.css({position: sidebarInitialPos});
          componentToggle
            .data("placement", "bottom")
            .attr("data-original-title", "Show component list");
          components.hide();
          hidden = true;
        },
        queue: false
      });
      sidebar.animate({ top: sidebarInitialTop + "px" }, { queue: false});
    }

    // Inject a component into the componet list DOM.
    function injectComponent(index, component) {
      componentList.append('<div class="component"><h4><a href="' + component.url + '">' + component.name + '</a></h4><p>' + component.description + '</p></div>');
    }

    // Parse the component list, build the DOM, and display it.
    function parseComponentList(components) {
      $.each(components, injectComponent);
      showComponentList();
    }

    // Fetch the component list and display it.
    function loadComponentList () {
      $.ajax({
        url: "//docs.zendframework.com/zf-mkdoc-theme/scripts/zf-component-list.json",
        dataType: "text json",
        success: parseComponentList,
        error: function (e) {
          console.log("Error occurred with XHR call", e);
        }
      });
    }
  });
</script>
    </body>

</html>
