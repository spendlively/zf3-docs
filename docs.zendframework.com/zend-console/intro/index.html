<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>Intro - zend-console</title>

    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href="//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Libre+Baskerville:400,400italic,700&subset=latin,latin-ext" rel="stylesheet" type="text/css">
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/zf-web.css" rel="stylesheet">
    <link href="../css/zf.css" rel="stylesheet">
    <link href="../css/prism-zf.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <span class="navbar-brand">
              <a class="logo-link" href="http://framework.zend.com" data-toggle="tooltip" data-placement="bottom" title="Zend Framework"><img src="../img/zf-logo-mark.svg" height="28" alt="Zend Framework" /></a>
              <a href="..">zend-console</a>
            </span>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li class="active">
                        <a href="./">Intro</a>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../adapter/">Console Adapters</a>
</li>

                        
                            
<li >
    <a href="../prompts/">Console Prompts</a>
</li>

                        
                            
<li >
    <a href="../routes/">Routes</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">MVC Integration <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../mvc/routing/">MVC Routing</a>
</li>

                        
                            
<li >
    <a href="../mvc/modules/">Console-Aware Modules</a>
</li>

                        
                            
<li >
    <a href="../mvc/controllers/">Console-Aware Controllers</a>
</li>

                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Getopt <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li >
    <a href="../getopt/intro/">Introduction</a>
</li>

                        
                            
<li >
    <a href="../getopt/rules/">Declaring Rules</a>
</li>

                        
                            
<li >
    <a href="../getopt/fetching/">Fetching Options and Arguments</a>
</li>

                        
                            
<li >
    <a href="../getopt/configuration/">Configuration</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" class="component-toggle" data-toggle="tooltip" data-placement="bottom" title="Show component list">
                        <i class="fa fa-book"></i> Components
                    </a>
                </li>

                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li>
                        <a href="https://github.com/zendframework/zend-console">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <!-- content:begin -->
    <div id="page-top" class="container docs">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#introduction-to-zend-console">Introduction to zend-console</a></li>
        
            <li><a href="#quick-start-with-zend-mvc">Quick Start with zend-mvc</a></li>
        
            <li><a href="#handling-console-requests">Handling console requests</a></li>
        
            <li><a href="#adding-console-usage-info">Adding console usage info</a></li>
        
    
    </ul>

    
    <ul class="pager hidden-print">
      <li class="previous">
        <a rel="prev" href=".."><i class="fa fa-arrow-left"></i> Previous</a>
      </li>
      <li class="next">
        <a rel="next" href="../adapter/">Next <i class="fa fa-arrow-right"></i></a>
      </li>
    </ul>
    
</div></div>
        <div class="col-md-9" role="main">

<ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
  <li><a href="..">zend-console</a> &raquo;</li>
  
    
  
  <li class="active">Intro</li>
</ol>

<h1 id="introduction-to-zend-console">Introduction to zend-console</h1>
<p>zend-console provides both generic support for routable console applications, as
well as the basis for adding console support to zend-mvc-based applications.</p>
<p>When a zend-mvc application is run from a console window (a shell window or
Windows command prompt), it will recognize this fact and prepare zend-mvc
components to handle the request. Console support is enabled by default, but to
function properly it requires at least one <a href="../routes/">console route</a> and one
<a href="http://framework.zend.com/manual/current/zend.mvc.controllers.html">action controller</a>
to handle the request.</p>
<p>Alternately, you can build console-aware applications that are standalone;
<a href="https://github.com/zfcampus/zf-console">zf-console</a> provides a standardized
workflow for doing so.</p>
<p>Features in zend-console include:</p>
<ul>
<li><a href="../routes/">Console routing</a> allows you to invoke handlers (including
  controller actions) depending on command line parameters provided by the user.</li>
<li><a href="../adapter/">Console adapters</a> provide abstraction for interacting with
  consoles exposed by different operating systems.</li>
<li><a href="../prompts/">Console prompts</a> allow user interaction by asking questions and
  retrieving input.</li>
</ul>
<p>When used with <a href="https://github.com/zendframework/zend-mvc">zend-mvc</a>, the
following features are also available:</p>
<ul>
<li><a href="../mvc/modules/">Module Manager integration</a> allows zend-mvc applications and
  modules to display help and usage information, either on demand, or in
  situations where no route was matched.</li>
<li><a href="../mvc/controllers/">Console-aware action controllers</a> will receive a console
  request containing all named parameters and flags. They are able to send
  output back to the console window.</li>
</ul>
<h2 id="quick-start-with-zend-mvc">Quick Start with zend-mvc</h2>
<blockquote>
<p>The following example details integration of zend-console with zend-mvc.
However, all information pertaining to routing can also be used <em>without</em>
zend-mvc, but requires that you react to the routing results yourself. The
aforementioned zf-console provides some basic wiring around that, and can and
should be consulted if you do not choose to use zend-console with zend-mvc.</p>
</blockquote>
<p>A console route defines required and optional command line parameters. When a
route matches, it returns an array of matched parameters &mdash; which may
include default parameters, or even parameters not exposed via the command line
(e.g., metadata related to the route).</p>
<p>Let's assume that we'd like our application to handle the following command line:</p>
<pre class="codehilite"><code class="language-bash">$ zf user resetpassword user@mail.com</code></pre>


<p>When a user runs our application (<code>zf</code>) with these parameters, we'd like to call
the action <code>resetpassword</code> of <code>Application\Controller\IndexController</code>.</p>
<blockquote>
<h3 id="the-zf-command">The zf command</h3>
<p>We will use <code>zf</code> to depict the entry point for your application; it can be
a shell script in the application's <code>bin/</code> directory, or simply an alias for <code>php
public/index.php</code>.</p>
</blockquote>
<p>First we need to create a <strong>route definition</strong>:</p>
<pre class="codehilite"><code>user resetpassword &lt;userEmail&gt;</code></pre>


<p>This simple route definition expects exactly three arguments: the literal
"user", the literal "resetpassword", and the dynamic argument we're calling
"userEmail". Let's assume we also accept one optional parameter to enable
verbose operation:</p>
<pre class="codehilite"><code>user resetpassword [--verbose|-v] &lt;userEmail&gt;</code></pre>


<p>The modified console route above expects the same three arguments from our
original example, but will also recognise an optional <code>--verbose</code> flag, or its
shorthand version, <code>-v</code>.</p>
<blockquote>
<h3 id="flag-order">Flag order</h3>
<p>The order of flags is ignored by zend-console. Flags can appear before
positional parameters, after them, or anywhere in between. The order of
multiple flags is also irrelevant. This applies both to route definitions and
the order that flags are used on the command line.</p>
</blockquote>
<p>Let's use the definition above and configure our console route. When using
zend-mvc, console routes are defined using the following configuration
structure:</p>
<pre class="codehilite"><code class="language-php">return [
    'router' =&gt; [
        'routes' =&gt; [
            // HTTP routes are defined here
        ],
    ],

    'console' =&gt; [
        'router' =&gt; [
            'routes' =&gt; [
                // Console routes go here
            ],
        ],
    ],

    /* ... */
];</code></pre>


<p>Let's create our console route and point it to
<code>Application\Controller\IndexController::resetpasswordAction()</code>:</p>
<pre class="codehilite"><code class="language-php">// We could define routes for Application\Controller\IndexController in
// the Application module config file, usually located at
// modules/application/config/module.config.php, or in one of the
// config/autoload/*.php files.
return [
    'console' =&gt; [
        'router' =&gt; [
            'routes' =&gt; [
                'user-reset-password' =&gt; [
                    'options' =&gt; [
                        'route'    =&gt; 'user resetpassword [--verbose|-v] &lt;userEmail&gt;',
                        'defaults' =&gt; [
                            'controller' =&gt; Application\Controller\Index::class,
                            'action'     =&gt; 'resetpassword',
                        ],
                    ],
                ],
            ],
        ],
    ],
    /* ... */
;</code></pre>


<h2 id="handling-console-requests">Handling console requests</h2>
<p>When a user runs our application from the command line and arguments match our
console route, the specified controller will be instantiated, and the specified
action method will be called, just as happens with zend-mvc HTTP requests.</p>
<p>As such, let's add the <code>resetpassword</code> action to our
<code>Application\Controller\IndexController</code>:</p>
<pre class="codehilite"><code class="language-php">&lt;?php
namespace Application\Controller;

use RuntimeException;
use Zend\Mvc\Controller\AbstractActionController;
use Zend\View\Model\ViewModel;
use Zend\Console\Request as ConsoleRequest;
use Zend\Math\Rand;

class IndexController extends AbstractActionController
{
    /* ... */

    public function resetpasswordAction()
    {
        $request = $this-&gt;getRequest();

        // Make sure that we are running in a console, and the user has not
        // tricked our application into running this action from a public web
        // server:
        if (! $request instanceof ConsoleRequest) {
            throw new RuntimeException('You can only use this action from a console!');
        }

        // Get user email from the console, and check if the user requested
        // verbosity:
        $userEmail   = $request-&gt;getParam('userEmail');
        $verbose     = $request-&gt;getParam('verbose') || $request-&gt;getParam('v');

        // Reset new password
        $newPassword = Rand::getString(16);

        // Fetch the user and change his password, then email him ...
        /* ... */

        if ($verbose) {
            return &quot;Done! New password for user $userEmail is '$newPassword'. &quot;
                . &quot;It has also been emailed to him.\n&quot;;
        }

        return &quot;Done! $userEmail has received an email with his new password.\n&quot;;

    }
}</code></pre>


<p>The above creates <code>resetpasswordAction()</code>, which:</p>
<ul>
<li>retrieves the current request;</li>
<li>checks if it's really coming from the console (as a precaution); in this
  example, we do not want our action to be invocable from a web page;</li>
<li>pulls console arguments via <code>$request-&gt;getParam()</code>; flags are represented by
  boolean values, where <code>true</code> means the flag was used, and <code>false</code> means
  otherwise;</li>
<li>performs work based on the arguments;</li>
<li>and finally returns a simple string to display to the user via the console.</li>
</ul>
<h2 id="adding-console-usage-info">Adding console usage info</h2>
<p>Console applications commonly display usage information when run without
arguments. The combination of zend-console and zend-mvc enables this out of the
box. Modules can provide usage information, and zend-console will query all loaded
modules for console usage information they expose.</p>
<p>Let's modify our <code>Application\Module</code> to provide usage info:</p>
<pre class="codehilite"><code class="language-php">&lt;?php

namespace Application;

use Zend\ModuleManager\Feature\AutoloaderProviderInterface;
use Zend\ModuleManager\Feature\ConfigProviderInterface;
use Zend\ModuleManager\Feature\ConsoleUsageProviderInterface;
use Zend\Console\Adapter\AdapterInterface as Console;

/**
 * Implementing ConsoleUsageProviderInterface allows the Module to provide
 * console usage information.
 */
class Module implements
    AutoloaderProviderInterface,
    ConfigProviderInterface,
    ConsoleUsageProviderInterface
{
    public function getConfig()
    {
        /* ... */
    }

    public function getAutoloaderConfig()
    {
        /* ... */
    }

    public function getConsoleUsage(Console $console)
    {
        return [
            // Describe available commands
            'user resetpassword [--verbose|-v] EMAIL' =&gt; 'Reset password for a user',

            // Describe expected parameters
            [ 'EMAIL',        'Email of the user for a password reset' ],
            [ '--verbose|-v', '(optional) turn on verbose mode'        ],
        ];
    }
}</code></pre>


<p>Each module that implements <code>ConsoleUsageProviderInterface</code> will be queried for
console usage info.  On route mismatch, all info from all modules will be
concatenated, formatted to console width, and shown to the user.</p>
<blockquote>
<h3 id="usage-order">Usage Order</h3>
<p>The order of usage info displayed in the console is in the same order in which
modules load. If you want your application to display important usage info
first, change the order your modules are loaded.</p>
</blockquote>

<hr />


<nav>
  <ul class="pager hidden-print">
    <li class="previous">
      <a rel="prev" href=".."><i class="fa fa-arrow-left"></i> Previous</a>
    </li>
    <li class="next">
      <a rel="next" href="../adapter/">Next <i class="fa fa-arrow-right"></i></a>
    </li>
  </ul>
</nav>
</div>
        
    </div>
    <!-- content:end -->

    <div id="footerwrap">
    <div class="container">
        <div class="row site-map">
            <div class="col-lg-3">
              <p>
                <strong>Zend Framework</strong><br />
                <a href="http://framework.zend.com/">framework.zend.com</a><br />
                <a href="https://docs.zendframework.com">docs.zendframework.com</a><br />
                <a href="https://packages.zendframework.com">packages.zendframework.com</a><br />
                <a href="https://apigility.org">apigility.org</a><br />
              </p>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 centered">
                <a class="back-to-top" href="#page-top"><i class="fa fa-chevron-circle-up fa-4" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="spacing"></div>

        <div class="row">
            <div class="col-lg-8">
                <h4>Copyright</h4>
                <div class="hline-w"></div>

                <p>&copy; 2006-2016 by <a href="http://www.zend.com">Zend</a>, a <a href="http://www.roguewave.com/">Rogue Wave Company</a>.</p>
            </div>

            <div class="col-lg-4">
                <h4>Contacts</h4>
                <div class="hline-w"></div>
                <p>
                    <a href="irc://irc.freenode.net/zftalk" class="btn-social btn-outline" alt="IRC" title="IRC"><i class="fa fa-comment"></i></a>
                    <a href="https://github.com/zendframework" class="btn-social btn-outline" alt="Github" title="Github"><i class="fa fa-github"></i></a>
                    <a href="https://twitter.com/zfdevteam" class="btn-social btn-outline" alt="Twitter" title="Twitter"><i class="fa fa-twitter"></i></a>
                </p>
            </div>
        </div>
    </div>
</div>


    <script src="../js/jquery-1.10.2.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>
    <script src="../js/prism-zf.js"></script>

    <script>var base_url = '..';</script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
    <script src="../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    <div class="zf-components">
  <div class="zf-components-grid">
    <div class="zf-logo">
      <a href="http://framework.zend.com" data-toggle="tooltip" data-placement="bottom" title="Go to the ZF homepage"><img src="../img/zf-logo-mark.svg" alt="Zend Framework" width="250" /></a>
    </div>

    <div class="component-list"></div>

    <p class="zf-components-rollup"><a href="#">Hide list</a></p>
  </div>
</div>

    <script>
  // Prepare the component list dropdown for display
  $(function () {
    var components = $(".zf-components"),
        componentList = components.find(".component-list"),
        sidebar = $(".bs-sidebar.affix"),
        sidebarInitialPos = sidebar.css("position"),
        hidden,
        componentToggle = $(".component-toggle"),
        navbar = $(".navbar-fixed-top"),
        rollUpLink = $(".zf-components-rollup a");

    // Initial setup on document load
    components.insertBefore(navbar);
    $(".zf-logo a").tooltip();
    componentToggle.tooltip();
    rollUpLink.attr({ href: "#", alt: "Hide component list" });

    // Cast initial sidebar position value
    if (undefined === sidebarInitialPos) {
      sidebarInitialPos = "fixed";
    }

    // Setup onclick events to toggle list
    componentToggle.click(toggleComponentList);
    rollUpLink.click(toggleComponentList);

    // Toggle the component list display
    function toggleComponentList(event) {
      event.preventDefault();

      if (hidden === undefined) {
        // Not loaded yet; load and display.
        loadComponentList();
        return;
      }

      if (hidden) {
        // Hidden; display.
        showComponentList();
        return;
      }

      // Currently visible; hide
      hideComponentList();
    }

    // Show the component list
    function showComponentList() {
      navbar.css({position: "relative"});
      sidebar.css({position: "relative"});
      components
        .css({"margin-top": "-" + components.outerHeight() + "px"})
        .show()
        .animate({"margin-top": 0}, {
          complete: function () {
            componentToggle
              .data("placement", "top")
              .attr("data-original-title", "Hide component list");
            hidden = false;
          },
          queue: false
        });
    }

    // Hide the component list
    function hideComponentList() {
      components.animate({"margin-top": "-" + components.outerHeight() + "px"}, {
        complete: function () {
          navbar.css({position: "fixed"});
          sidebar.css({position: sidebarInitialPos});
          componentToggle
            .data("placement", "bottom")
            .attr("data-original-title", "Show component list");
          components.hide();
          hidden = true;
        },
        queue: false
      });
      sidebar.animate({ top: sidebarInitialTop + "px" }, { queue: false});
    }

    // Inject a component into the componet list DOM.
    function injectComponent(index, component) {
      componentList.append('<div class="component"><h4><a href="' + component.url + '">' + component.name + '</a></h4><p>' + component.description + '</p></div>');
    }

    // Parse the component list, build the DOM, and display it.
    function parseComponentList(components) {
      $.each(components, injectComponent);
      showComponentList();
    }

    // Fetch the component list and display it.
    function loadComponentList () {
      $.ajax({
        url: "//docs.zendframework.com/zf-mkdoc-theme/scripts/zf-component-list.json",
        dataType: "text json",
        success: parseComponentList,
        error: function (e) {
          console.log("Error occurred with XHR call", e);
        }
      });
    }
  });
</script>
    </body>

</html>
