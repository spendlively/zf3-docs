<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">  
    <link rel="shortcut icon" href="../img/favicon.ico">

    <title>Definitions - zend-di</title>

    <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="//cdn.jsdelivr.net/font-hack/2.018/css/hack.min.css">
    <link href="//fonts.googleapis.com/css?family=PT+Sans:400,400italic,700,700italic&subset=latin-ext,latin" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,700italic,400,300,600,700&subset=latin-ext,latin" rel="stylesheet" type="text/css">
    <link href="//fonts.googleapis.com/css?family=Libre+Baskerville:400,400italic,700&subset=latin,latin-ext" rel="stylesheet" type="text/css">
    <link href="../css/base.css" rel="stylesheet">
    <link href="../css/zf-web.css" rel="stylesheet">
    <link href="../css/zf.css" rel="stylesheet">
    <link href="../css/prism-zf.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

    <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.5.18/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Open Sans', 'PT Sans']
        }
    });
    </script>

    
</head>

<body>

    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <span class="navbar-brand">
              <a class="logo-link" href="http://framework.zend.com" data-toggle="tooltip" data-placement="bottom" title="Zend Framework"><img src="../img/zf-logo-mark.svg" height="28" alt="Zend Framework" /></a>
              <a href="..">zend-di</a>
            </span>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="..">Home</a>
                    </li>
                
                
                
                    <li >
                        <a href="../intro/">Intro</a>
                    </li>
                
                
                
                    <li >
                        <a href="../quick-start/">Quick Start</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Reference <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            
<li class="active">
    <a href="./">Definitions</a>
</li>

                        
                            
<li >
    <a href="../instance-manager/">Instance Manager</a>
</li>

                        
                            
<li >
    <a href="../config/">Configuration</a>
</li>

                        
                            
<li >
    <a href="../debugging-and-complex-use-cases/">Debugging and Complex Use Cases</a>
</li>

                        
                        </ul>
                    </li>
                
                
                </ul>
            

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" class="component-toggle" data-toggle="tooltip" data-placement="bottom" title="Show component list">
                        <i class="fa fa-book"></i> Components
                    </a>
                </li>

                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                
                    <li>
                        <a href="https://github.com/zendframework/zend-di">
                            
                                <i class="fa fa-github"></i>
                            
                            GitHub
                        </a>
                    </li>
                
            </ul>
        </div>
    </div>
</div>

    <!-- content:begin -->
    <div id="page-top" class="container docs">
        
        <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#dependency-definitions">Dependency Definitions</a></li>
        
            <li><a href="#definitionlist">DefinitionList</a></li>
        
            <li><a href="#runtimedefinition">RuntimeDefinition</a></li>
        
            <li><a href="#compilerdefinition">CompilerDefinition</a></li>
        
            <li><a href="#classdefinition">ClassDefinition</a></li>
        
    
    </ul>

    
    <ul class="pager hidden-print">
      <li class="previous">
        <a rel="prev" href="../quick-start/"><i class="fa fa-arrow-left"></i> Previous</a>
      </li>
      <li class="next">
        <a rel="next" href="../instance-manager/">Next <i class="fa fa-arrow-right"></i></a>
      </li>
    </ul>
    
</div></div>
        <div class="col-md-9" role="main">

<ol class="breadcrumb" role="navigation" aria-label="breadcrumbs navigation">
  <li><a href="..">zend-di</a> &raquo;</li>
  
    
      
        <li>Reference &raquo;</li>
      
    
  
  <li class="active">Definitions</li>
</ol>

<h1 id="dependency-definitions">Dependency Definitions</h1>
<p>Definitions are what zend-di uses to understand the structure of the code it is
attempting to wire. This means that if you've written non-ambiguous, clear and
concise code, zend-di has a very good chance of understanding how to wire things
up without much added complexity.</p>
<h2 id="definitionlist">DefinitionList</h2>
<p>Definitions are introduced to the <code>Zend\Di\Di</code> object through a definition list
implemented as <code>Zend\Di\DefinitionList</code> (which extends <code>SplDoublyLinkedList</code>).
Order is important. Definitions in the front of the list will be consulted on a
class before definitions at the end of the list.</p>
<blockquote>
<h3 id="autoloading">Autoloading</h3>
<p>Regardless of what kind of DefinitionList strategy you decide to use, it is
important that your autoloaders are already setup and ready to use.</p>
</blockquote>
<h2 id="runtimedefinition">RuntimeDefinition</h2>
<p>The default <code>DefinitionList</code> instantiated by <code>Zend\Di\Di</code> when no other
DefinitionList is provided is <code>Zend\Di\Definition\RuntimeDefinition</code>. The
<code>RuntimeDefinition</code> will respond to queries about classes by using PHP's
Reflection API. The <code>RuntimeDefinition</code> uses any available information inside
methods &mdash; including their signature, the names of parameters, the
type-hints of the parameters, and the default values &mdash; to determine if
something is optional or required when making a call to that method. The more
explicit you can be in your method naming and method signatures, the more likely
<code>Zend\Di\Definition\RuntimeDefinition</code> will accurately understand the structure
of your code.</p>
<p>The constructor of <code>RuntimeDefinition</code> looks like the following:</p>
<pre class="codehilite"><code class="language-php">public function __construct(
    IntrospectionStrategy $introspectionStrategy = null,
    array $explicitClasses = null
) {
    $this-&gt;introspectionStrategy = ($introspectionStrategy) ?: new IntrospectionStrategy();
    if ($explicitClasses) {
        $this-&gt;setExplicitClasses($explicitClasses);
    }
}</code></pre>


<p>The <code>IntrospectionStrategy</code> object is an object that defines the rules by which
the <code>RuntimeDefinition</code> will introspect information about your classes. Here are
the things it knows how to do:</p>
<ul>
<li>Whether or not to use annotations (scanning and parsing annotations is
  expensive, and thus disabled by default)</li>
<li>Which method names to include in the introspection; this is a list of
  patterns. By default, it registers the pattern <code>/^set\[A-Z\]{1}\\w\*/</code>.</li>
<li>Which interface names represent the interface injection pattern; this is a
  list of patterns. By default, the pattern <code>/\\w\*Aware\\w\*/</code> is registered.</li>
</ul>
<p>The constructor for the <code>IntrospectionStrategy</code> looks like this:</p>
<pre class="codehilite"><code class="language-php">public function __construct(AnnotationManager $annotationManager = null)
{
    $this-&gt;annotationManager = ($annotationManager) ?: $this-&gt;createDefaultAnnotationManager();
}</code></pre>


<p>The <code>AnnotationManager</code> is not required. If you wish to create a special
<code>AnnotationManager</code> with your own annotations, and also wish to extend the
<code>RuntimeDefinition</code> to look for those annotations, this is the place to do it.</p>
<p>The <code>RuntimeDefinition</code> also can be used to look up either all classes
(implicitly, which is default), or explicitly look up for particular pre-defined
classes. This is useful when your strategy for inspecting one set of classes
might differ from those of another strategy for another set of classes. This can
be achieved by using the <code>setExplicitClasses()</code> method or by passing a list of
classes as the second constructor argument of the <code>RuntimeDefinition</code>.</p>
<h2 id="compilerdefinition">CompilerDefinition</h2>
<p>The <code>CompilerDefinition</code> is similar in nature to the <code>RuntimeDefinition</code> with the exception
that it can be seeded with more information for the purposes of "compiling" a
definition. Compiled definitions eliminate reflection calls and annotation
scannning, which can be a performance bottleneck in your production
applications.</p>
<p>For example, let's assume we want to create a script that will create
definitions for some of our library code:</p>
<pre class="codehilite"><code class="language-php">// in &quot;package name&quot; format
$components = [
    'My_MovieApp',
    'My_OtherClasses',
];

foreach ($components as $component) {
    $diCompiler = new Zend\Di\Definition\CompilerDefinition;
    $diCompiler-&gt;addDirectory('/path/to/classes/' . str_replace('_', '/', $component));

    $diCompiler-&gt;compile();
    file_put_contents(
        __DIR__ . '/../data/di/' . $component . '-definition.php',
        '&lt;?php return ' . var_export($diCompiler-&gt;toArrayDefinition()-&gt;toArray(), true) . ';'
    );
}</code></pre>


<p>The above creates a file for each "package", containing the full definition for
the classes defined for each. To utilize this in an application, use the
following:</p>
<pre class="codehilite"><code class="language-php">protected function setupDi(Application $app)
{
    $definitionList = new DefinitionList([
        new Definition\ArrayDefinition(include __DIR__ .  '/path/to/data/di/My_MovieApp-definition.php'),
        new Definition\ArrayDefinition(include __DIR__ .  '/path/to/data/di/My_OtherClasses-definition.php'),
        $runtime = new Definition\RuntimeDefinition(),
    ]);
    $di = new Di($definitionList, null, new Config($this-&gt;config-&gt;di));
    $di-&gt;instanceManager()-&gt;addTypePreference('Zend\Di\LocatorInterface', $di);
    $app-&gt;setLocator($di);
}</code></pre>


<p>The above code would more than likely go inside your application's bootstrap or
within a <code>Module</code> class. This represents the simplest and most performant way
of configuring your DiC for usage.</p>
<h2 id="classdefinition">ClassDefinition</h2>
<p>The idea behind using a <code>ClassDefinition</code> is two-fold. First, you may want to
override some information inside of a <code>RuntimeDefinition</code>. Secondly, you might
want to simply define your complete class's definition with an xml, ini, or php
file describing the structure. This class definition can be fed in via
<code>Configuration</code> or by directly instantiating and registering the <code>Definition</code>
with the <code>DefinitionList</code>.</p>
<p>(@todo - example)</p>

<hr />


<nav>
  <ul class="pager hidden-print">
    <li class="previous">
      <a rel="prev" href="../quick-start/"><i class="fa fa-arrow-left"></i> Previous</a>
    </li>
    <li class="next">
      <a rel="next" href="../instance-manager/">Next <i class="fa fa-arrow-right"></i></a>
    </li>
  </ul>
</nav>
</div>
        
    </div>
    <!-- content:end -->

    <div id="footerwrap">
    <div class="container">
        <div class="row site-map">
            <div class="col-lg-3">
              <p>
                <strong>Zend Framework</strong><br />
                <a href="http://framework.zend.com/">framework.zend.com</a><br />
                <a href="https://docs.zendframework.com">docs.zendframework.com</a><br />
                <a href="https://packages.zendframework.com">packages.zendframework.com</a><br />
                <a href="https://apigility.org">apigility.org</a><br />
              </p>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-12 centered">
                <a class="back-to-top" href="#page-top"><i class="fa fa-chevron-circle-up fa-4" aria-hidden="true"></i></a>
            </div>
        </div>

        <div class="spacing"></div>

        <div class="row">
            <div class="col-lg-8">
                <h4>Copyright</h4>
                <div class="hline-w"></div>

                <p>&copy; 2006-2016 by <a href="http://www.zend.com">Zend</a>, a <a href="http://www.roguewave.com/">Rogue Wave Company</a>.</p>
            </div>

            <div class="col-lg-4">
                <h4>Contacts</h4>
                <div class="hline-w"></div>
                <p>
                    <a href="irc://irc.freenode.net/zftalk" class="btn-social btn-outline" alt="IRC" title="IRC"><i class="fa fa-comment"></i></a>
                    <a href="https://github.com/zendframework" class="btn-social btn-outline" alt="Github" title="Github"><i class="fa fa-github"></i></a>
                    <a href="https://twitter.com/zfdevteam" class="btn-social btn-outline" alt="Twitter" title="Twitter"><i class="fa fa-twitter"></i></a>
                </p>
            </div>
        </div>
    </div>
</div>


    <script src="../js/jquery-1.10.2.min.js"></script>
    <script src="../js/bootstrap-3.0.3.min.js"></script>
    <script src="../js/prism-zf.js"></script>

    <script>var base_url = '..';</script>
    <script data-main="../mkdocs/js/search.js" src="../mkdocs/js/require.js"></script>
    <script src="../js/base.js"></script>

    <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <span aria-hidden="true">&times;</span>
                        <span class="sr-only">Close</span>
                    </button>
                    <h4 class="modal-title" id="exampleModalLabel">Search</h4>
                </div>
                <div class="modal-body">
                    <p>
                        From here you can search these documents. Enter your search terms below.
                    </p>
                    <form role="form">
                        <div class="form-group">
                            <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                        </div>
                    </form>
                    <div id="mkdocs-search-results"></div>
                </div>
                <div class="modal-footer">
                </div>
            </div>
        </div>
    </div>

    <div class="zf-components">
  <div class="zf-components-grid">
    <div class="zf-logo">
      <a href="http://framework.zend.com" data-toggle="tooltip" data-placement="bottom" title="Go to the ZF homepage"><img src="../img/zf-logo-mark.svg" alt="Zend Framework" width="250" /></a>
    </div>

    <div class="component-list"></div>

    <p class="zf-components-rollup"><a href="#">Hide list</a></p>
  </div>
</div>

    <script>
  // Prepare the component list dropdown for display
  $(function () {
    var components = $(".zf-components"),
        componentList = components.find(".component-list"),
        sidebar = $(".bs-sidebar.affix"),
        sidebarInitialPos = sidebar.css("position"),
        hidden,
        componentToggle = $(".component-toggle"),
        navbar = $(".navbar-fixed-top"),
        rollUpLink = $(".zf-components-rollup a");

    // Initial setup on document load
    components.insertBefore(navbar);
    $(".zf-logo a").tooltip();
    componentToggle.tooltip();
    rollUpLink.attr({ href: "#", alt: "Hide component list" });

    // Cast initial sidebar position value
    if (undefined === sidebarInitialPos) {
      sidebarInitialPos = "fixed";
    }

    // Setup onclick events to toggle list
    componentToggle.click(toggleComponentList);
    rollUpLink.click(toggleComponentList);

    // Toggle the component list display
    function toggleComponentList(event) {
      event.preventDefault();

      if (hidden === undefined) {
        // Not loaded yet; load and display.
        loadComponentList();
        return;
      }

      if (hidden) {
        // Hidden; display.
        showComponentList();
        return;
      }

      // Currently visible; hide
      hideComponentList();
    }

    // Show the component list
    function showComponentList() {
      navbar.css({position: "relative"});
      sidebar.css({position: "relative"});
      components
        .css({"margin-top": "-" + components.outerHeight() + "px"})
        .show()
        .animate({"margin-top": 0}, {
          complete: function () {
            componentToggle
              .data("placement", "top")
              .attr("data-original-title", "Hide component list");
            hidden = false;
          },
          queue: false
        });
    }

    // Hide the component list
    function hideComponentList() {
      components.animate({"margin-top": "-" + components.outerHeight() + "px"}, {
        complete: function () {
          navbar.css({position: "fixed"});
          sidebar.css({position: sidebarInitialPos});
          componentToggle
            .data("placement", "bottom")
            .attr("data-original-title", "Show component list");
          components.hide();
          hidden = true;
        },
        queue: false
      });
      sidebar.animate({ top: sidebarInitialTop + "px" }, { queue: false});
    }

    // Inject a component into the componet list DOM.
    function injectComponent(index, component) {
      componentList.append('<div class="component"><h4><a href="' + component.url + '">' + component.name + '</a></h4><p>' + component.description + '</p></div>');
    }

    // Parse the component list, build the DOM, and display it.
    function parseComponentList(components) {
      $.each(components, injectComponent);
      showComponentList();
    }

    // Fetch the component list and display it.
    function loadComponentList () {
      $.ajax({
        url: "//docs.zendframework.com/zf-mkdoc-theme/scripts/zf-component-list.json",
        dataType: "text json",
        success: parseComponentList,
        error: function (e) {
          console.log("Error occurred with XHR call", e);
        }
      });
    }
  });
</script>
    </body>

</html>
